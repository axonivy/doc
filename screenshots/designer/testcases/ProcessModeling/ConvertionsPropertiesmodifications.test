--- RCPTT testcase ---
Format-Version: 1.0
Element-Name: ConvertionsPropertiesmodifications
Element-Type: testcase
Element-Version: 3.0
External-Reference: 
Id: _xSFEAF78Eea4DszzhZF9qA
Runtime-Version: 2.5.3.202205021448
Save-Time: 6/13/22, 5:54 PM
Testcase-Type: ecl

------=_.content-0a7243a0-75d3-3d5f-9791-539de0e5b7ac
Content-Type: text/ecl
Entry-Name: .content

importProject -projectName oldVersionProject

try
{
	get-eclipse-window | get-object | invoke setSize 1100 387
	get-view "Axon Ivy Projects" | get-button "Collapse All.*" | click
	wait 1000
	find-tab-folder "Axon Ivy Projects" | get-object | captureScreenshot "ivy-project/convert-invoking-conversion.png"
	get-eclipse-window | get-object | invoke setSize 1000 600
	with [get-view "Axon Ivy Projects" | get-tree] {
		get-item oldVersionProject | click
		select oldVersionProject | get-menu Validate | click
	}
	get-window "Validation Results" | get-button OK | click
	get-view Problems | click
	get-button "View Menu" | click
	get-view Problems | get-menu "Show/Show All" | click
	get-view Problems | get-menu "Show/Errors\\/Warnings on Project" | click
	wait 1000
	get-view "Axon Ivy Projects" | get-tree | get-item oldVersionProject | click
	with [get-view Problems | get-tree] {
		select "Errors (.*)/Project has wrong version and needs to be converted.*"
	}

	get-eclipse-window | resizeWindow 1100 800
	find-tab-folder Problems | get-object | captureScreenshot "ivy-project/convert-wrong-version.png"
	with [get-view "Axon Ivy Projects" | get-tree] {
		get-item oldVersionProject | click
		select oldVersionProject | get-menu Properties | click
	}
	with [get-window "Properties for.*"] {
		get-tree | select "Axon Ivy"
		wait 500
		resizeWindow 570 400
		saveWindowContentScreenshot "ivy-project/convert-project-version-before-conversion.png"
		get-button Cancel | click
	}
	with [get-view "Axon Ivy Projects" | get-tree] {
		get-item oldVersionProject | click
		select oldVersionProject | get-menu "Convert Project" | click
	}	
	with [get-window "Convert Project oldVersionProject"] {
		saveWindowContentScreenshot "ivy-project/convert-project-1.png"
		get-button "Next >" | click
		saveWindowContentScreenshot "ivy-project/convert-project-2.png"		
		get-button Convert | click
		saveWindowContentScreenshot "ivy-project/convert-project-3.png"
		get-button Finish | click
	}
	
	with [get-view "Axon Ivy Projects" | get-tree] {
		get-item oldVersionProject | click
		select oldVersionProject | get-menu Properties | click
	}
	with [get-window "Properties for.*"] {
		get-tree | select "Axon Ivy"
		wait 500
		resizeWindow 570 400
		saveWindowContentScreenshot "ivy-project/convert-project-version-after-conversion.png"
		saveWindowContentScreenshot "ivy-project/preferences-convert-project.png"
		get-button Cancel | click
	}

	importProject "QuickStartTutorial"

	get-view "Axon Ivy Projects" | get-tree | get-menu "Export..." | click
	with [get-window Export] {
		get-tree | select "Axon Ivy/Ivy Archive.*"
		get-button "Next >" | click
	}
	with [get-window "Export ivy Archive (*.iar)"] {
		resizeWindow 500 250
		get-combo -after [get-label "Ivy Project to Export"] | select QuickStartTutorial
		with [get-combo -after [get-label "Ivy Archive file"]] {
			set-text "C:\\temp\\iar\\QuickStartTutorial.iar"
		}
		wait 500
		saveWindowContentScreenshot "ivy-project/project-export-wizard.png"
		get-button Cancel | click
	}
	with [get-view "Axon Ivy Projects" | get-tree] {
		get-item oldVersionProject | click
		select oldVersionProject | get-menu Properties | click
	}

	get-window "Properties for oldVersionProject" | get-button "Apply and Close" | click
}-finally{
	deleteProject oldVersionProject
	deleteProject QuickStartTutorial
}

------=_.content-0a7243a0-75d3-3d5f-9791-539de0e5b7ac--
